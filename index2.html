<html lang="ru">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Валентинка</title>
 <style>
 /* Общие стили */
 * {
 box-sizing: border-box;
 margin:0;
 padding:0;
 }
 html, body {
 height:100%;
 overflow: hidden;
 font-family: 'Arial', sans-serif;
 background: #000;
 }
 #app {
 position: relative;
 width:100%;
 height:100%;
 text-align: center;
 color: #fff;
 user-select: none;
 cursor: pointer;
 overflow: hidden;
 transition: transform1.5s ease-in-out;
 z-index:1;
 }
 #initialBg {
 position: absolute;
 top:0;
 left:0;
 width:100%;
 height:100%;
 background: url("https://xmple.com/wallpaper/gradient-purple-linear-black-2880x5120-c2-ff00ff-000000-a-90-f-14.svg") no-repeat center center;
 background-size: cover;
 z-index: -1;
 transition: transform1.5s ease-in-out;
 }
 #mainText {
 position: absolute;
 top:38%;
 width:100%;
 font-size:60px;
 font-weight:900;
 z-index:2;
 text-shadow:4px4px8px #000;
 opacity:1;
 transition: transform1.5s ease-in-out, opacity1.5s ease-in-out;
 animation: pulseText2s infinite alternate;
 }
 @keyframes pulseText {
 from { text-shadow:4px4px8px #000; }
 to { text-shadow:8px8px16px #ff00ff; }
 }
 #hint {
 position: absolute;
 top:50%;
 width:100%;
 font-size:14px;
 font-weight: normal;
 opacity:0.1;
 z-index:2;
 transition: transform1.5s ease-in-out, opacity1.5s ease-in-out;
 }
 #restartBtn {
 position: absolute;
 bottom:20px;
 left:50%;
 transform: translateX(-50%);
 padding:10px20px;
 font-size:18px;
 background-color: #28a745;
 border: none;
 border-radius:5px;
 cursor: pointer;
 z-index:10;
 display: none;
 }
 #neonHeart {
 position: absolute;
 top:50%;
 left:50%;
 transform: translate(-50%, -50%);
 z-index:4;
 display: none;
 }
 #pulsingHeart {
 position: absolute;
 top:50%;
 left:50%;
 transform: translate(-50%, -50%);
 width:150px;
 height:150px;
 background: radial-gradient(circle, #ff69b440%, transparent70%);
 border-radius:50%;
 box-shadow:0020px rgba(255,105,180,0.8);
 z-index:5;
 display: none;
 animation: pulse1.5s infinite;
 }
 @keyframes pulse {
0% { transform: translate(-50%, -50%) scale(1); }
50% { transform: translate(-50%, -50%) scale(1.1); }
100% { transform: translate(-50%, -50%) scale(1); }
 }
 #particleCanvas {
 position: absolute;
 top:0;
 left:0;
 width:100%;
 height:100%;
 z-index:6;
 pointer-events: none;
 }
 </style>
</head>
<body>
 <div id="app">
 <div id="initialBg"></div>
 <div id="mainText">Люблю тебя♥️</div>
 <div id="hint">нажми</div>
 <div id="neonHeart">
 <svg viewBox="00200200" width="200" height="200">
 <path id="heartPath" d="M100,30 C70,5050,8050,120 A50,5000,0150,120 C150,80130,50100,30 Z"
 fill="none"
 stroke="#ff69b4"
 stroke-width="4"
 stroke-linecap="round"
 stroke-dasharray="628"
 stroke-dashoffset="628">
 <animate attributeName="stroke-dashoffset"
 from="628" to="0"
 dur="2s"
 fill="freeze" />
 <animate attributeName="stroke-dasharray"
 from="0628" to="6280"
 dur="2s"
 fill="freeze" />
 </path>
 </svg>
 <style>
 #heartPath {
 filter: drop-shadow(0010px #ff69b4) drop-shadow(0020px #ff69b4) drop-shadow(0030px #ff69b4);
 }
 </style>
 </div>
 <div id="pulsingHeart"></div>
 <canvas id="particleCanvas"></canvas>
 <button id="restartBtn">Начать сначала</button>
 </div>

 <script>
 const app = document.getElementById('app');
 const initialBg = document.getElementById('initialBg');
 const mainText = document.getElementById('mainText');
 const hint = document.getElementById('hint');
 const neonHeart = document.getElementById('neonHeart');
 const pulsingHeart = document.getElementById('pulsingHeart');
 const restartBtn = document.getElementById('restartBtn');
 const particleCanvas = document.getElementById('particleCanvas');
 const pctx = particleCanvas.getContext('2d');

 let canvasWidth = window.innerWidth;
 let canvasHeight = window.innerHeight;
 particleCanvas.width = canvasWidth;
 particleCanvas.height = canvasHeight;

 let stage =1;
 console.log("Начальный этап: stage =", stage);

 const kiraAttributes = [
 "Любимая", "Моя звезда", "Нежная", "Очаровательная", "Уникальная",
 "Мечта", "Свет", "Вдохновение", "Счастье", "Радость"
 ];

 function animate() {
 requestAnimationFrame(animate);
 if (stage ===5) {
 pctx.fillStyle = 'rgba(0,0,0,0.05)';
 pctx.fillRect(0,0, canvasWidth, canvasHeight);
 }
 }

 app.addEventListener('click', (e) => {
 if (stage ===1) {
 stage =2;
 console.log("Переход на этап2");
 app.style.transform = "translateY(-50%)";
 mainText.style.transform = "translateY(-50%)";
 hint.style.transform = "translateY(-50%)";
 mainText.style.animation = "none";
 setTimeout(() => {
 stage =3;
 console.log("Переход на этап3");
 neonHeart.style.display = "block";
 pulsingHeart.style.display = "block";
 },1500);
 } else if (stage ===3) {
 const randomEffect = Math.random();
 if (randomEffect <0.5) {
 heartEffect();
 } else {
 kiraEffect();
 }
 stage =4;
 } else if (stage ===4 && e.target === restartBtn) {
 stage =1;
 app.style.transform = "";
 mainText.style.transform = "";
 hint.style.transform = "";
 mainText.style.animation = "pulseText2s infinite alternate";
 neonHeart.style.display = "none";
 pulsingHeart.style.display = "none";
 particleCanvas.getContext('2d').clearRect(0,0, canvasWidth, canvasHeight);
 console.log("Перезагрузка");
 }
 });

 function heartEffect() {
 pulsingHeart.style.opacity = "1";
 animateHeart();
 }

 function kiraEffect() {
 const randomAttribute = kiraAttributes[Math.floor(Math.random() * kiraAttributes.length)];
 mainText.textContent = randomAttribute;
 mainText.style.opacity = "0";
 setTimeout(() => {
 mainText.style.opacity = "1";
 mainText.style.transform = "translateY(-50%)";
 },500);
 }

 function animateHeart() {
 pulsingHeart.style.transform = "translate(-50%, -50%) scale(1.1)";
 setTimeout(() => {
 pulsingHeart.style.transform = "translate(-50%, -50%) scale(1)";
 animateHeart();
 },1000);
 }

 function init() {
 particleCanvas.width = window.innerWidth;
 particleCanvas.height = window.innerHeight;
 pctx.fillStyle = "rgba(0,0,0,0.1)";
 pctx.fillRect(0,0, canvasWidth, canvasHeight);
 console.log("Инициализация завершена");
 }

 animate();
 init();

 window.addEventListener('resize', () => {
 canvasWidth = window.innerWidth;
 canvasHeight = window.innerHeight;
 particleCanvas.width = canvasWidth;
 particleCanvas.height = canvasHeight;
 pctx.fillStyle = "rgba(0,0,0,0.1)";
 pctx.fillRect(0,0, canvasWidth, canvasHeight);
 });
 </script>
</body>
</html>
